---
title: "Homework-15-11-2019"
author: "Khó͘ gē choân"
output: html_document
---


## 12.14

### a. 
想知道研究的人群擁有某些基因的比例是否等於15%。

- 虛無假設：擁有某些基因的人群比例不等於15%
- 對立假設：基因某些基因的人群比例等於15%
- H0:p=.15
- Ha:p!=≠.15

### b.
想知道糖果包中有紅色包裝的糖果的比例是否有達到30%。
- 虛無假設：紅色包裝的糖果比例是30%
- 對立假設：紅色包裝的糖果比例不是30%

- H0:p=0.3
- Ha:p<0.3

## 12.26

### a. 14%

### b.

他說因為機率而得到這樣的結果的機率小於5%，代表它具有統計上的顯著性（如果我們把alpha定為5%）。 

### c.
A p-value is measured as the probability of the test statistic obtained as extreme or more extreme than the observed value of test statistic. P值的意思是說在虛無假設為真的前提下，我們透過觀測得到等於或大於特定的觀測統計量的統計量的機率。

### d.
透過統計得到的觀測值主要應該用來驗證知識，如果沒有合理的推論過程，例如說為什麼賀爾蒙會影響到決定小孩性別的基因，否則不適合單純依據統計資料下結論。

## 12.38

### a.
虛無假設：婦人沒有懷孕
對立假設：婦人有懷孕
Type 1 error：虛無假設為真，但我們拒絕了虛無假設。
在這個情境裡，就是其實那位婦人沒有懷孕，但檢測結果顯示她有懷孕。

### b. 
Type 2 error: 對立假設為真，但我們認為我們不能拒絕虛無假設。
在這個情境裡，就是其實那位婦人有懷孕，但檢測結果顯示她沒有懷孕。

### c.
有懷孕但卻沒有檢測出來應該會比較嚴重（Type 2 error）。在有懷孕的情況下，婦人會有身理上的改變以及可能需要調整的一些習慣，如果誤以為沒有懷孕的話可能會對身體有影響。

## 12.54


## 12.68

#### 第一步:設定假設
我們想知道大學裡的男性如果有打耳洞，是否有更高的機率也會刺青？
虛無假設:有打耳洞的男性大學生刺青的比例（p1）等於沒有打耳洞的男性大學生刺青的比例(p2)
對立假設:有打耳洞的男性大學生刺青的比例大於沒有打耳洞的男性大學生刺青的比例

- H0:p1=p2
- Ha:p1>p2

**顯著水準alpha=0.05**

#### 第二步：確認進行統計檢驗的條件、找出適當的統計測驗

``` {r}


n1=141
n2=424
p1=42/141
p2=43/424

n1*p1
n1*(1-p1)
n2*p2
n2*(1-p2)

## 統計量足夠大，np或n(1-p)都有大於10

p.hat=(n1*p1+n2*p2)/(n1+n2)
z68=(p1-p2)/sqrt(p.hat*(1-p.hat)*((1/n1)+(1/n2)))

## z值等於5.65


```

#### 第三步：決定p值

目標是知道有打耳洞的大學男性刺青的比例有沒有高於沒有打耳洞的大學男性，因此是單邊的檢驗。

```{r}

pnorm(5.65)
## 用pnorm求常態分佈下距離5.65個標準差的累積機率的話會太接近1。
## 查表A1之後得到距離5.61的標準差時累積機率是 .99999999
## 所以p值就是1-.99999999=0.00000001

1- .99999999

```

#### 第四步：決定虛無假設是否成立

很明顯p值遠遠小於顯著水準alpha，我們判斷虛無假設被拒絕。

#### 第五步：結論

根據p值遠小於顯著水準alphe，我們判斷虛無假設被拒絕，也就是對立假設成立：有打耳洞的大學男性刺青的機率高於沒有打耳洞的大學男性。

## 12.84


```{r}

# a.

p.hat84=.25
p0=.2
n84=400

z84=(p.hat84-p0)/sqrt(p0*(1-p0)/n84)

z84
# z值等於2.5

# b.

#我們的對立假設是比例大於0.2，因此是單邊的檢定。
#p值是距離大於2.5個標準差之後的累積機率。

p.value84=1-pnorm(2.5)
p.value84

# p值等於0.006209665 

# c
#我們設定顯著水準alpha等於0.05，因為p值低於alpha，所以我們拒絕虛無假設成立。
#結論如同對立假設，母體的比例大於0.2。
rm(list=ls())
p.hat=.25
p0=.2
n=100
z=(p.hat-p0)/sqrt(p0*(1-p0)/n)
z
# z值等於1.25。因為是單邊的檢驗，p值是常態分佈下超過1.25個標準差之後的累積機率
1-pnorm(1.25)
# p值等於0.1056498

#因為p值大於我們設定的alpha，因此我們不能拒絕虛無假設，無法確定母體的比例大於0.2

# d.

#樣本統計量小的時候，z值也跟著變小，統計量越大才越有可能得到符合顯著水準的結果


```

### R程式練習題

根據實習課提供的資料(UCBAdmissions.Rdata)，請分別檢視各科系的研究生入學申請錄取率，在男女間的差異，進一步評估與討論該大學在研究生入學申請是否有性別歧視(sex discrimination)的疑慮。

```{r}

rdata=get(load("/Users/CHAN_0830/Life&Work/Statictic_R/UCBAdmissions.rdata"))


#虛無假設：女性的錄取率和男性的錄取率相同
#對立假設：女性的錄取率和男性的錄取率不相同
#顯著水準alpha＝0.05
#雙邊的檢定

#共有六個部門，合併之後得到錄取男性＝512+353+120+138+53+22=1198
#不錄取男性＝351+138+279+205+207+313=1193

#錄取女性=24+94+131+202+17+89=476
#不錄取女性=317+299+244+391+8+19=1278

#男性的總數nＭ和錄取比率pＭ
nM=1198+1193
pM=1198/nM

#女性的總數nF和錄取比率pF
nF=476+1278
pF=476/nF


#全部部門合併後的檢定
prop.test(x=c(1198, 476), n=c(2391, 1754), alternative = "two.sided", conf.level = 0.95, correct = F)
#p值等於

#部門Ａ的男性總數na.M和錄取比率pa.M
na.M=512+313
pa.M=512/na.M

#部門A的女性總數na.F和錄取比率na.F
na.F=89+19
pa.F=89/na.F

#部門Ａ的檢定
prop.test(x=c(512, 89), n=c(na.M, na.F), alternative = "two.sided", conf.level = 0.95, correct = F)
# p值等於0.000328，小於alpha

#部門Ｂ的檢定
prop.test(x=c(253, 207), n=c(253+17, 207+8), alternative = "two.sided", conf.level = 0.95, correct = F)
# p值等於0.2026

#部門C的檢定
prop.test(x=c(120, 205), n=c(120+205, 202+391), alternative = "two.sided", conf.level = 0.95, correct = F)
#P值等於0.4959


rdata=split(rdata, rdata$Dept)

#部門D的檢定
prop.test(x=c(138, 131), n=c(138+279, 131+244), alternative = "two.sided", conf.level = 0.95, correct = F)
#P值等於0.5852

#部門Ｅ的檢定
prop.test(x=c(22, 24), n=c(22+351, 24+317), alternative = "two.sided", conf.level = 0.95, correct = F)
# p值等於0.5354

#單一個部門一一檢定的時候樣本數較少，因此p值較大，可以看到只有部們Ａ, B, C小於alpha。合併再一起之後樣本數增加，整體的p值遠小於alpha。

#基於p值遠小於顯著水準0.05，我們可以拒絕虛無假設，也就是錄取與否沒有性別歧視的虛無假設不成立。結論是這所大學在錄取學生上存在性別差異，女性的錄取率較低，而且這個差異不太可能只是因為隨機變數所導致。
```



